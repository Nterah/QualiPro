<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>PQP Summary – {{ project.Code }}</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    @media print { .no-print { display:none } }
    th, td { font-size: 12px; }
  </style>
</head>
<body class="p-3">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h4 class="mb-0">PQP Summary — {{ project.Code }}</h4>
    <button class="btn btn-sm btn-outline-secondary no-print" onclick="window.print()">Print / Save PDF</button>
  </div>
  {% for s in sections %}
    <h5 class="mt-4">{{ s.index }}. Section</h5>
    <div class="table-responsive">
      <table class="table table-bordered table-sm">
        <thead class="table-light">
          <tr>{% for c in s.columns %}<th>{{ c }}</th>{% endfor %}</tr>
        </thead>
        <tbody>
          {% if s.rows %}
            {% for r in s.rows %}
              <tr>
                {% for c in s.columns %}
                  <td>{{ r[c] if r is mapping else (r[loop.index0] if loop.index0 < (r|length) else '') }}</td>
                {% endfor %}
              </tr>
            {% endfor %}
          {% else %}
            <tr><td colspan="{{ s.columns|length }}" class="text-center text-muted">No data</td></tr>
          {% endif %}
        </tbody>
      </table>
    </div>
  {% endfor %}
</body>
</html>
